(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{gekI:function(n,l,t){"use strict";t.r(l);var e=t("CcnG"),a=function(){},u=t("pMnS"),r=t("Ip0R"),i=function(){function n(){}return n.prototype.ngOnInit=function(){},n}(),o=e.La({encapsulation:2,styles:[],data:{}});function s(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,6,"div",[["class","tags has-addons"]],null,null,null,null,null)),(n()(),e.Na(1,0,null,null,1,"span",[["class","tag is-dark"]],null,null,null,null,null)),(n()(),e.db(2,null,["",""])),(n()(),e.Na(3,0,null,null,3,"span",[],null,null,null,null,null)),e.Ma(4,278528,null,0,r.k,[e.q,e.r,e.k,e.B],{ngClass:[0,"ngClass"]},null),e.Ya(5,2),(n()(),e.db(6,null,["",""]))],function(n,l){n(l,4,0,n(l,5,0,"tag",l.component.tagClass))},function(n,l){var t=l.component;n(l,2,0,t.caption),n(l,6,0,t.value)})}var c=function(){function n(){}return n.prototype.ngOnInit=function(){},n}(),d=e.La({encapsulation:2,styles:[],data:{}});function p(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,3,"div",[["class","control"]],null,null,null,null,null)),(n()(),e.Na(1,0,null,null,2,"app-data-tag",[],null,null,null,s,o)),e.Ma(2,114688,null,0,i,[],{caption:[0,"caption"],value:[1,"value"],tagClass:[2,"tagClass"]},null),e.ab(3,2)],function(n,l){n(l,2,0,l.context.$implicit.caption,e.eb(l,2,1,n(l,3,0,e.Xa(l.parent,0),l.context.$implicit.value,"1.0-0")),l.context.$implicit.class)},null)}function h(n){return e.fb(0,[e.Za(0,r.f,[e.s]),(n()(),e.Na(1,0,null,null,2,"div",[["class","field is-grouped is-grouped-multiline"]],null,null,null,null,null)),(n()(),e.Ea(16777216,null,null,1,null,p)),e.Ma(3,278528,null,0,r.l,[e.M,e.J,e.q],{ngForOf:[0,"ngForOf"]},null),(n()(),e.Na(4,0,null,null,2,"progress",[],[[8,"value",0],[8,"max",0]],null,null,null,null)),e.Ma(5,278528,null,0,r.k,[e.q,e.r,e.k,e.B],{ngClass:[0,"ngClass"]},null),e.Ya(6,2),(n()(),e.Na(7,0,null,null,0,"br",[],null,null,null,null,null))],function(n,l){var t=l.component;n(l,3,0,t.indicator.tags),n(l,5,0,n(l,6,0,"progress",t.indicator.class))},function(n,l){var t=l.component;n(l,4,0,t.indicator.value,t.indicator.max)})}var g=function(){function n(){this.brakeDisabled=!1,this.throttleDisabled=!1,this.brake=new e.m,this.throttle=new e.m}return n.prototype.ngOnInit=function(){},n}(),f=e.La({encapsulation:2,styles:[],data:{}});function v(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,6,"section",[["class","field is-grouped"]],null,null,null,null,null)),(n()(),e.Na(1,0,null,null,2,"span",[["class","control"]],null,null,null,null,null)),(n()(),e.Na(2,0,null,null,1,"button",[["class","button is-danger is-outlined is-large"]],[[8,"disabled",0]],[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.brake.next()&&e),e},null,null)),(n()(),e.db(-1,null,["Brake"])),(n()(),e.Na(4,0,null,null,2,"span",[["class","control"]],null,null,null,null,null)),(n()(),e.Na(5,0,null,null,1,"button",[["class","button is-primary is-outlined is-large"]],[[8,"disabled",0]],[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.throttle.next()&&e),e},null,null)),(n()(),e.db(-1,null,["Throttle"]))],null,function(n,l){var t=l.component;n(l,2,0,t.brakeDisabled),n(l,5,0,t.throttleDisabled)})}var b=t("gIcY"),y=function(){function n(){this.recharge=new e.m,this.rechargedDistance=0}return n.prototype.ngOnInit=function(){},n}(),m=e.La({encapsulation:2,styles:[],data:{}});function S(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,17,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],function(n,l,t){var a=!0,u=n.component;return"submit"===l&&(a=!1!==e.Xa(n,2).onSubmit(t)&&a),"reset"===l&&(a=!1!==e.Xa(n,2).onReset()&&a),"ngSubmit"===l&&(a=!1!==u.recharge.next(u.rechargedDistance)&&a),a},null,null)),e.Ma(1,16384,null,0,b.p,[],null,null),e.Ma(2,4210688,null,0,b.k,[[8,null],[8,null]],null,{ngSubmit:"ngSubmit"}),e.bb(2048,null,b.b,null,[b.k]),e.Ma(4,16384,null,0,b.j,[[4,b.b]],null,null),(n()(),e.Na(5,0,null,null,12,"div",[],null,null,null,null,null)),(n()(),e.Na(6,0,null,null,11,"div",[["class","field has-addons"]],null,null,null,null,null)),(n()(),e.Na(7,0,null,null,7,"div",[["class","control"]],null,null,null,null,null)),(n()(),e.Na(8,0,null,null,6,"input",[["class","input"],["name","rechargedDistance"],["placeholder","Kilometers"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],function(n,l,t){var a=!0,u=n.component;return"input"===l&&(a=!1!==e.Xa(n,9)._handleInput(t.target.value)&&a),"blur"===l&&(a=!1!==e.Xa(n,9).onTouched()&&a),"compositionstart"===l&&(a=!1!==e.Xa(n,9)._compositionStart()&&a),"compositionend"===l&&(a=!1!==e.Xa(n,9)._compositionEnd(t.target.value)&&a),"change"===l&&(a=!1!==e.Xa(n,10).onChange(t.target.value)&&a),"input"===l&&(a=!1!==e.Xa(n,10).onChange(t.target.value)&&a),"blur"===l&&(a=!1!==e.Xa(n,10).onTouched()&&a),"ngModelChange"===l&&(a=!1!==(u.rechargedDistance=t)&&a),a},null,null)),e.Ma(9,16384,null,0,b.c,[e.B,e.k,[2,b.a]],null,null),e.Ma(10,16384,null,0,b.o,[e.B,e.k],null,null),e.bb(1024,null,b.g,function(n,l){return[n,l]},[b.c,b.o]),e.Ma(12,671744,null,0,b.l,[[2,b.b],[8,null],[8,null],[6,b.g]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),e.bb(2048,null,b.h,null,[b.l]),e.Ma(14,16384,null,0,b.i,[[4,b.h]],null,null),(n()(),e.Na(15,0,null,null,2,"div",[["class","control"]],null,null,null,null,null)),(n()(),e.Na(16,0,null,null,1,"button",[["class","button is-primary"],["type","submit"]],null,null,null,null,null)),(n()(),e.db(-1,null,["Recharge"]))],function(n,l){n(l,12,0,"rechargedDistance",l.component.rechargedDistance)},function(n,l){n(l,0,0,e.Xa(l,4).ngClassUntouched,e.Xa(l,4).ngClassTouched,e.Xa(l,4).ngClassPristine,e.Xa(l,4).ngClassDirty,e.Xa(l,4).ngClassValid,e.Xa(l,4).ngClassInvalid,e.Xa(l,4).ngClassPending),n(l,8,0,e.Xa(l,14).ngClassUntouched,e.Xa(l,14).ngClassTouched,e.Xa(l,14).ngClassPristine,e.Xa(l,14).ngClassDirty,e.Xa(l,14).ngClassValid,e.Xa(l,14).ngClassInvalid,e.Xa(l,14).ngClassPending)})}var C=t("9W44"),T=t("SHZb"),I=t("6blF"),k=t("T1DM"),B=t("/21U");function N(n){var l=n.subscriber,t=n.counter,e=n.period;l.next(t),this.schedule({subscriber:l,counter:t+1,period:e},e)}var D=t("mrSG"),M=t("MGBS"),w=t("rPjj"),X=t("zotm"),x=t("67Y/"),j=t("0/uQ");function O(n,l){return"function"==typeof l?function(t){return t.pipe(O(function(t,e){return Object(j.a)(n(t,e)).pipe(Object(x.a)(function(n,a){return l(t,n,e,a)}))}))}:function(l){return l.lift(new V(n))}}var V=function(){function n(n){this.project=n}return n.prototype.call=function(n,l){return l.subscribe(new E(n,this.project))},n}(),E=function(n){function l(l,t){var e=n.call(this,l)||this;return e.project=t,e.index=0,e}return D.b(l,n),l.prototype._next=function(n){var l,t=this.index++;try{l=this.project(n,t)}catch(n){return void this.destination.error(n)}this._innerSub(l,n,t)},l.prototype._innerSub=function(n,l,t){var e=this.innerSubscription;e&&e.unsubscribe();var a=new w.a(this,void 0,void 0);this.add(a),this.innerSubscription=Object(X.a)(this,n,l,t,a)},l.prototype._complete=function(){var l=this.innerSubscription;l&&!l.closed||n.prototype._complete.call(this)},l.prototype._unsubscribe=function(){this.innerSubscription=null},l.prototype.notifyComplete=function(l){this.remove(l),this.innerSubscription=null,this.isStopped&&n.prototype._complete.call(this)},l.prototype.notifyNext=function(n,l,t,e,a){this.destination.next(l)},l}(M.a),U=t("xMyE"),$=t("AytR"),P=t("nsGb"),G=t("Ocbj"),R=[{value:0,max:0,class:"is-info",tags:[{caption:"Speed",value:0,class:"is-info"},{caption:"Top",value:0,class:"is-danger"}]},{value:0,max:0,class:"is-success",tags:[{caption:"Traveled",value:0,class:"is-success"},{caption:"Remaining",value:0,class:"is-danger"}]}],_=function(){function n(){this.indicators=R,this.speedIndicator=this.indicators[0],this.batteryIndicator=this.indicators[1]}return n.prototype.initilizeIndicators=function(n){return this.speedIndicator.max=n.topSpeed,this.speedIndicator.tags[1].value=n.topSpeed,this.batteryIndicator.max=n.totalBattery,this.updateIndicators(n),this.indicators},n.prototype.updateIndicators=function(n){return this.speedIndicator.value=n.currentSpeed,this.speedIndicator.class=this.getSpeedClass(n),this.speedIndicator.tags[0].value=n.currentSpeed,this.batteryIndicator.value=n.remainingBattery,this.batteryIndicator.class=this.getBatteryClass(n),this.batteryIndicator.tags[0].value=n.distanceTraveled,this.batteryIndicator.tags[1].value=n.remainingBattery,this.indicators},n.prototype.getBatteryClass=function(n){return n.remainingBattery<=$.a.dangerKmsBattery?"is-danger":n.remainingBattery<=$.a.warningKmsBattery?"is-warning":"is-success"},n.prototype.getSpeedClass=function(n){var l=n.currentSpeed/n.topSpeed;return l>=$.a.dangerSpeedRate?"is-danger":l>=$.a.warningSpeedRate?"is-warning":"is-info"},n}(),F=function(){function n(){var n=this;this.oneHourSecs=3600,this.hasBattery=function(n){return n.remainingBattery>0},this.isBrakeDisabled=function(n){return n.currentSpeed<=0},this.isThrottleDisabled=function(n){return n.currentSpeed>=n.topSpeed},this.deltaSpeed=function(l){return n.rawDeltaSpeed(l)/$.a.factorSpeed},this.rawDeltaSpeed=function(n){return n.topSpeed-n.currentSpeed+1},this.travelDistance=function(l){var t=l.currentSpeed*$.a.timeTravel/n.oneHourSecs;l.distanceTraveled+=t,l.remainingBattery-=t},this.getValidatedRecharging=function(n,l){var t=n;return!n||n<0?t=0:n>l.totalBattery&&(t=l.totalBattery),t}}return n.prototype.brake=function(n){n.currentSpeed-=this.deltaSpeed(n),n.currentSpeed<=1&&(n.currentSpeed=0)},n.prototype.throttle=function(n){n.currentSpeed+=this.deltaSpeed(n),n.currentSpeed>n.topSpeed&&(n.currentSpeed=n.topSpeed)},n.prototype.recharge=function(n,l){l.remainingBattery=this.getValidatedRecharging(n,l)},n.prototype.checkBattery=function(n){n.remainingBattery<=n.currentSpeed?this.stopCar(n):this.travelDistance(n)},n.prototype.stopCar=function(n){n.currentSpeed=0,n.distanceTraveled+=n.remainingBattery,n.remainingBattery=0},n}(),J=t("9Z1F"),L=t("t/Na"),Z=function(){function n(n){var l=this;this.http=n,this.travelsUrl=$.a.apiUrl+"priv/travels",this.getCarTravel$=function(n){return l.tryGetTravel$(n).pipe(Object(J.a)(function(t){return l.postIfNotFound(t,n)}),Object(x.a)(function(t){return l.getCarWithTravel(n,t)}))},this.postCarTravel$=function(n){return l.http.post(l.travelsUrl,l.getTravel(n))},this.putCarTravel$=function(n){return l.http.put(l.getUrlTravel(n),l.getTravel(n))},this.deleteCarTravel$=function(n){return l.http.delete(l.getUrlTravel(n))},this.tryGetTravel$=function(n){return l.http.get(l.getUrlTravel(n))},this.getUrlTravel=function(n){return l.travelsUrl+"/"+l.getTravelId(n)},this.getTravel=function(n){return{_id:l.getTravelId(n),currentSpeed:n.currentSpeed,remainingBattery:n.remainingBattery,distanceTraveled:n.distanceTraveled,owner:n.owner}},this.getCarWithTravel=function(n,l){return n.currentSpeed=l.currentSpeed,n.remainingBattery=l.remainingBattery,n.distanceTraveled=l.distanceTraveled,n.owner=l.owner,n},this.getTravelId=function(n){return""+n.link.routerLink},this.postIfNotFound=function(n,t){return 404===n.status?l.postCarTravel$(t):(e=n,new I.a(function(n){return n.error(e)}));var e}}return n.ngInjectableDef=e.Q({factory:function(){return new n(e.U(L.c))},token:n,providedIn:"root"}),n}(),q=function(){function n(n,l,t,e,a,u){var r=this;this.route=n,this.cars=l,this.display=t,this.engine=e,this.travels=a,this.globalStore=u,this.hasTravelData=!1,this.hasPendingChanges=void 0,this.onBrake=function(){r.engine.brake(r.car),r.hasPendingChanges=!0},this.onThrottle=function(){r.engine.throttle(r.car),r.hasPendingChanges=!0},this.onRecharge=function(n){return r.engine.recharge(n,r.car)},this.onSaveTravel=function(){return r.travels.putCarTravel$(r.car).subscribe(null,null,function(){return r.hasPendingChanges=!1})},this.onDeleteTravel=function(){return r.travels.deleteCarTravel$(r.car).subscribe(null,null,function(){return r.hasPendingChanges=!1})},this.hasBattery=function(){return r.engine.hasBattery(r.car)},this.isBrakeDisabled=function(){return r.engine.isBrakeDisabled(r.car)},this.isThrottleDisabled=function(){return r.engine.isThrottleDisabled(r.car)},this.onCarGotten=function(n){r.car=n,r.indicators=r.display.initilizeIndicators(r.car)},this.onCarTravelGotten=function(n){return r.hasTravelData=!0},this.timeGoesBy=function(n){r.engine.checkBattery(r.car),r.indicators=r.display.updateIndicators(r.car)}}return n.prototype.ngOnInit=function(){var n=this;this.subscription=this.route.params.pipe(Object(x.a)(function(n){return n.carId}),O(function(l){return n.cars.getCarByLinkId$(l)}),Object(U.a)(this.onCarGotten),O(function(l){return n.travels.getCarTravel$(l)}),Object(U.a)(this.onCarTravelGotten),O(function(n){return void 0===(l=$.a.refreshInterval)&&(l=0),void 0===t&&(t=k.a),(!Object(B.a)(l)||l<0)&&(l=0),t&&"function"==typeof t.schedule||(t=k.a),new I.a(function(n){return n.add(t.schedule(N,l,{subscriber:n,counter:0,period:l})),n});var l,t})).subscribe(this.timeGoesBy)},n.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},n.prototype.canBeDeactivated=function(){return void 0!==this.hasPendingChanges&&this.globalStore.dispatchUserMessage(this.hasPendingChanges?"Save or delete before exit !!":"You can go your own away ;-)"),!this.hasPendingChanges},n}(),Y=t("ZYCi"),K=e.La({encapsulation:2,styles:[],data:{}});function z(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,1,"app-indicator",[],null,null,null,h,d)),e.Ma(1,114688,null,0,c,[],{indicator:[0,"indicator"]},null)],function(n,l){n(l,1,0,l.context.$implicit)},null)}function H(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,1,"app-speed-controls",[],null,[[null,"brake"],[null,"throttle"]],function(n,l,t){var e=!0,a=n.component;return"brake"===l&&(e=!1!==a.onBrake()&&e),"throttle"===l&&(e=!1!==a.onThrottle()&&e),e},v,f)),e.Ma(1,114688,null,0,g,[],{brakeDisabled:[0,"brakeDisabled"],throttleDisabled:[1,"throttleDisabled"]},{brake:"brake",throttle:"throttle"})],function(n,l){var t=l.component;n(l,1,0,t.isBrakeDisabled(),t.isThrottleDisabled())},null)}function W(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,1,"app-battery-recharger",[],null,[[null,"recharge"]],function(n,l,t){var e=!0;return"recharge"===l&&(e=!1!==n.component.onRecharge(t)&&e),e},S,m)),e.Ma(1,114688,null,0,y,[],null,{recharge:"recharge"})],function(n,l){n(l,1,0)},null)}function Q(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,4,"section",[],null,null,null,null,null)),(n()(),e.Ea(16777216,null,null,1,null,H)),e.Ma(2,16384,null,0,r.m,[e.M,e.J],{ngIf:[0,"ngIf"]},null),(n()(),e.Ea(16777216,null,null,1,null,W)),e.Ma(4,16384,null,0,r.m,[e.M,e.J],{ngIf:[0,"ngIf"]},null)],function(n,l){var t=l.component;n(l,2,0,t.hasBattery()),n(l,4,0,!t.hasBattery())},null)}function A(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,1,"h1",[],null,null,null,null,null)),(n()(),e.db(-1,null,[" Loading travel data... "]))],null,null)}function nn(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,20,"article",[],null,null,null,null,null)),(n()(),e.Na(1,0,null,null,10,"app-card",[],null,null,null,C.b,C.a)),e.Ma(2,114688,null,0,T.a,[],{caption:[0,"caption"],value:[1,"value"]},null),e.ab(3,1),e.ab(4,2),(n()(),e.Na(5,0,null,0,2,"main",[],null,null,null,null,null)),(n()(),e.Ea(16777216,null,null,1,null,z)),e.Ma(7,278528,null,0,r.l,[e.M,e.J,e.q],{ngForOf:[0,"ngForOf"]},null),(n()(),e.Na(8,0,null,1,3,"footer",[],null,null,null,null,null)),(n()(),e.Ea(16777216,null,null,1,null,Q)),e.Ma(10,16384,null,0,r.m,[e.M,e.J],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),e.Ea(0,[["loadingTravel",2]],null,0,null,A)),(n()(),e.Na(12,0,null,null,0,"hr",[],null,null,null,null,null)),(n()(),e.Na(13,0,null,null,7,"section",[],null,null,null,null,null)),(n()(),e.Na(14,0,null,null,6,"div",[["class","field is-grouped"]],null,null,null,null,null)),(n()(),e.Na(15,0,null,null,2,"p",[["class","control"]],null,null,null,null,null)),(n()(),e.Na(16,0,null,null,1,"a",[["class","button is-success"]],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.onSaveTravel()&&e),e},null,null)),(n()(),e.db(-1,null,[" Save travel "])),(n()(),e.Na(18,0,null,null,2,"p",[["class","control"]],null,null,null,null,null)),(n()(),e.Na(19,0,null,null,1,"a",[["class","button is-danger"]],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.onDeleteTravel()&&e),e},null,null)),(n()(),e.db(-1,null,[" Delete travel "]))],function(n,l){var t=l.component;n(l,2,0,e.eb(l,2,0,n(l,3,0,e.Xa(l.parent,0),t.car.name)),e.eb(l,2,1,n(l,4,0,e.Xa(l.parent,1),t.car.cost,"EUR"))),n(l,7,0,t.indicators),n(l,10,0,t.hasTravelData,e.Xa(l,11))},null)}function ln(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,1,"h1",[],null,null,null,null,null)),(n()(),e.db(-1,null,[" Loading car... "]))],null,null)}function tn(n){return e.fb(0,[e.Za(0,r.r,[]),e.Za(0,r.d,[e.s]),(n()(),e.Ea(16777216,null,null,1,null,nn)),e.Ma(3,16384,null,0,r.m,[e.M,e.J],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),e.Ea(0,[["loading",2]],null,0,null,ln))],function(n,l){n(l,3,0,l.component.car,e.Xa(l,4))},null)}var en=e.Ja("app-car",q,function(n){return e.fb(0,[(n()(),e.Na(0,0,null,null,1,"app-car",[],null,null,null,tn,K)),e.Ma(1,245760,null,0,q,[Y.a,P.a,_,F,Z,G.a],null,null)],function(n,l){n(l,1,0)},null)},{},{},[]),an=function(){function n(){}return n.prototype.canDeactivate=function(n,l,t,e){return n.canBeDeactivated()},n}(),un=function(){},rn=t("PCNd");t.d(l,"CarModuleNgFactory",function(){return on});var on=e.Ka(a,[],function(n){return e.Ua([e.Va(512,e.j,e.Z,[[8,[u.a,en]],[3,e.j],e.v]),e.Va(4608,r.o,r.n,[e.s,[2,r.w]]),e.Va(4608,b.q,b.q,[]),e.Va(4608,_,_,[]),e.Va(4608,F,F,[]),e.Va(4608,an,an,[]),e.Va(1073742336,r.c,r.c,[]),e.Va(1073742336,Y.m,Y.m,[[2,Y.s],[2,Y.k]]),e.Va(1073742336,un,un,[]),e.Va(1073742336,b.n,b.n,[]),e.Va(1073742336,b.d,b.d,[]),e.Va(1073742336,rn.a,rn.a,[]),e.Va(1073742336,a,a,[]),e.Va(1024,Y.i,function(){return[[{path:":carId",component:q,canDeactivate:[an]}]]},[])])})}}]);